# Abook support
macro generic,index,pager \ca "<shell-escape>abook<return>" "launch abook"
macro index,pager  a "<pipe-message>abook --add-email-quiet<Enter>" "add this sender to Abook"
bind editor        <Tab> complete-query

### Macros ###
# urlscan support

macro index,pager \cb <pipe-entry>'urlscan'<enter> 'Follow links with urlscan'

### Mark as Read ###
macro index ,r "T(~(~N)|~(~O))<Enter>;WO;WN;t" "mark all new/old as read"

### Remove limit ###
macro index A  "l*<Enter>" "remove limit"

### Notmuch ###
macro index <F8> "<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
                 <shell-escape>notmuch-mutt -r --prompt search<enter>\
                 <change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>\
                 <enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>"\
                 "notmuch: search mail"

macro index <F9> "<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
                 <pipe-message>notmuch-mutt -r thread<enter>\
                 <change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>\
                 <enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>"\
                 "notmuch: reconstruct thread"

macro index <F6> "<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
                 <pipe-message>notmuch-mutt tag -- -inbox<enter>\
                 <enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>"\
                 "notmuch: remove message from inbox"

macro index . "<change-folder>-<enter>" \
              "return to last folder"

### General ###

## Pager
bind pager h previous-entry
bind pager l next-entry
bind pager H previous-thread
bind pager L next-thread
bind pager j next-line
bind pager k previous-line
bind pager gg top
bind pager G bottom
bind pager rr  reply
bind pager rg  group-reply
bind pager rl  list-reply
bind pager \CD half-down
bind pager \CU half-up
bind pager \CN sidebar-next
bind pager \CP sidebar-prev
bind pager \CO sidebar-open

## Index
bind index rr  reply
bind index rg  group-reply
bind index rl  list-reply
bind index gg  first-entry
bind index G   last-entry
bind index za  collapse-thread
bind index zA  collapse-all # Missing :folddisable/foldenable
bind index \CD half-down
bind index \CU half-up
bind index \CN sidebar-next
bind index \CP sidebar-prev
bind index \CO sidebar-open

### Generic ###
bind generic j next-entry
bind generic k previous-entry
bind generic gg first-entry
bind generic G last-entry
bind generic \CD half-down
bind generic \CU half-up

### Attachments
bind attach gg first-entry
bind attach G last-entry
bind attach \CD half-down
bind attach \CU half-up
